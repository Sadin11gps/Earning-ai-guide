<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RDS Admin Panel</title>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap');
        body { background-color: #0f172a; font-family: 'Inter', sans-serif; color: #f1f5f9; }
        .sidebar { width: 250px; background: #1e293b; height: 100vh; position: fixed; left: 0; top: 0; }
        .main-content { margin-left: 250px; padding: 20px; }
        .card { background: #334155; border-radius: 10px; padding: 20px; border: 1px solid #475569; }
        .nav-item { padding: 12px 20px; cursor: pointer; display: flex; align-items: center; gap: 10px; color: #94a3b8; transition: 0.2s; }
        .nav-item:hover, .nav-item.active { background: #3b82f6; color: white; }
        .status-badge { padding: 2px 8px; border-radius: 4px; font-size: 10px; font-weight: bold; text-transform: uppercase; }
        .btn { padding: 5px 12px; border-radius: 6px; font-size: 12px; font-weight: bold; cursor: pointer; }
        
        /* Modal */
        .modal { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.8); align-items: center; justify-content: center; z-index: 1000; }
        .modal-content { background: #1e293b; padding: 25px; rounded: 15px; width: 400px; max-width: 90%; }
    </style>
</head>
<body>

    <!-- Sidebar -->
    <div class="sidebar">
        <div class="p-6 border-b border-slate-700">
            <h1 class="text-xl font-black text-blue-500 italic">RDS ADMIN</h1>
        </div>
        <nav class="mt-4">
            <div class="nav-item active" onclick="showSection('dashboard')">üìä ‡¶°‡ßç‡¶Ø‡¶æ‡¶∂‡¶¨‡ßã‡¶∞‡ßç‡¶°</div>
            <div class="nav-item" onclick="showSection('users')">üë• ‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶≤‡¶ø‡¶∏‡ßç‡¶ü</div>
            <div class="nav-item" onclick="showSection('withdraws')">üí∏ ‡¶™‡ßá‡¶Æ‡ßá‡¶®‡ßç‡¶ü ‡¶∞‡¶ø‡¶ï‡ßã‡ßü‡ßá‡¶∏‡ßç‡¶ü</div>
            <div class="nav-item" onclick="showSection('settings')">‚öôÔ∏è ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶™ ‡¶∏‡ßá‡¶ü‡¶ø‡¶Ç‡¶∏</div>
        </nav>
    </div>

    <!-- Main Content -->
    <div class="main-content">
        
        <!-- Dashboard Section -->
        <div id="dashboard" class="section">
            <h2 class="text-2xl font-bold mb-6">‡¶ì‡¶≠‡¶æ‡¶∞‡¶≠‡¶ø‡¶â</h2>
            <div class="grid grid-cols-4 gap-6">
                <div class="card">
                    <p class="text-sm text-slate-400">‡¶Æ‡ßã‡¶ü ‡¶á‡¶â‡¶ú‡¶æ‡¶∞</p>
                    <h3 id="total-users" class="text-3xl font-black mt-2">0</h3>
                </div>
                <div class="card">
                    <p class="text-sm text-slate-400">‡¶Æ‡ßã‡¶ü ‡¶â‡¶á‡¶•‡¶°‡ßç‡¶∞ (Pending)</p>
                    <h3 id="pending-withdraw" class="text-3xl font-black mt-2 text-yellow-500">0</h3>
                </div>
                <div class="card">
                    <p class="text-sm text-slate-400">‡¶Ü‡¶ú‡¶ï‡ßá‡¶∞ ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶° ‡¶∞‡ßá‡¶ü</p>
                    <h3 id="current-rate" class="text-3xl font-black mt-2 text-green-500">$0.00</h3>
                </div>
                <div class="card">
                    <p class="text-sm text-slate-400">‡¶∏‡¶æ‡¶∏‡¶™‡ßá‡¶®‡ßç‡¶°‡ßá‡¶° ‡¶á‡¶â‡¶ú‡¶æ‡¶∞</p>
                    <h3 id="banned-users" class="text-3xl font-black mt-2 text-red-500">0</h3>
                </div>
            </div>
        </div>

        <!-- Users Section -->
        <div id="users" class="section hidden">
            <h2 class="text-2xl font-bold mb-4">‡¶∏‡¶ï‡¶≤ ‡¶á‡¶â‡¶ú‡¶æ‡¶∞</h2>
            <div class="bg-slate-800 rounded-xl overflow-hidden">
                <table class="w-full text-left text-sm text-slate-400">
                    <thead class="bg-slate-900 text-slate-200 uppercase font-bold">
                        <tr>
                            <th class="p-4">‡¶®‡¶æ‡¶Æ</th>
                            <th class="p-4">UID</th>
                            <th class="p-4">‡¶¨‡ßç‡¶Ø‡¶æ‡¶≤‡ßá‡¶®‡ßç‡¶∏</th>
                            <th class="p-4">‡¶∏‡ßç‡¶ü‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶∏</th>
                            <th class="p-4">‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶∂‡¶®</th>
                        </tr>
                    </thead>
                    <tbody id="user-table-body">
                        <!-- Users will load here -->
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Settings Section -->
        <div id="settings" class="section hidden">
            <h2 class="text-2xl font-bold mb-6">‡¶Ö‡ßç‡¶Ø‡¶æ‡¶™ ‡¶ï‡¶®‡ßç‡¶ü‡ßç‡¶∞‡ßã‡¶≤ ‡¶∏‡ßá‡¶ü‡¶ø‡¶Ç‡¶∏</h2>
            <div class="grid grid-cols-2 gap-8">
                <div class="card">
                    <h4 class="font-bold text-lg mb-4 text-blue-400">Ad & Reward Settings</h4>
                    <div class="space-y-4">
                        <div>
                            <label class="block text-xs text-slate-400 mb-1">Per Click Rate ($)</label>
                            <input id="set-rate" type="number" step="0.001" class="w-full bg-slate-900 border border-slate-700 p-2 rounded text-white" placeholder="0.01">
                        </div>
                        <div>
                            <label class="block text-xs text-slate-400 mb-1">Daily Ad Limit</label>
                            <input id="set-limit" type="number" class="w-full bg-slate-900 border border-slate-700 p-2 rounded text-white" placeholder="20">
                        </div>
                        <div>
                            <label class="block text-xs text-slate-400 mb-1">Signup Bonus ($)</label>
                            <input id="set-bonus" type="number" step="0.01" class="w-full bg-slate-900 border border-slate-700 p-2 rounded text-white" placeholder="0.50">
                        </div>
                        <button onclick="saveSettings()" class="w-full bg-green-600 hover:bg-green-700 py-2 rounded font-bold text-white mt-2">Save Changes</button>
                    </div>
                </div>
                
                <div class="card">
                    <h4 class="font-bold text-lg mb-4 text-red-400">Emergency Control</h4>
                    <p class="text-xs text-slate-400 mb-4">‡¶ú‡¶∞‡ßÅ‡¶∞‡ßÄ ‡¶™‡ßç‡¶∞‡ßü‡ßã‡¶ú‡¶®‡ßá ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶™ ‡¶Æ‡ßá‡¶á‡¶®‡¶ü‡ßá‡¶®‡ßá‡¶®‡ßç‡¶∏ ‡¶Æ‡ßã‡¶°‡ßá ‡¶®‡¶ø‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá‡¶®‡•§</p>
                    <div class="flex items-center justify-between bg-slate-900 p-3 rounded mb-4">
                        <span>Maintenance Mode</span>
                        <input type="checkbox" id="maintenance-mode" class="w-5 h-5">
                    </div>
                    <button class="w-full bg-red-600/20 text-red-500 border border-red-500/50 py-2 rounded font-bold hover:bg-red-600 hover:text-white transition">Update Status</button>
                </div>
            </div>
        </div>

    </div>

    <!-- Edit User Modal -->
    <div id="userModal" class="modal">
        <div class="card w-96 relative">
            <span onclick="closeModal()" class="absolute top-4 right-4 cursor-pointer text-2xl">&times;</span>
            <h3 class="text-xl font-bold mb-4" id="modal-username">User Actions</h3>
            <input type="hidden" id="modal-uid">
            
            <div class="space-y-3">
                <div>
                    <label class="text-xs">‡¶¨‡ßç‡¶Ø‡¶æ‡¶≤‡ßá‡¶®‡ßç‡¶∏ ‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶® (+/-)</label>
                    <div class="flex gap-2">
                        <input id="modal-balance" type="number" step="0.01" class="flex-1 bg-slate-900 p-2 rounded text-white border border-slate-600">
                        <button onclick="updateBalance()" class="bg-blue-600 px-4 rounded font-bold">Update</button>
                    </div>
                </div>
                <hr class="border-slate-600 my-4">
                <h4 class="font-bold text-red-400 text-sm">Suspension Actions</h4>
                <div class="grid grid-cols-2 gap-2">
                    <button onclick="suspendUser(24)" class="bg-yellow-600/20 text-yellow-500 border border-yellow-600 p-2 rounded text-xs font-bold hover:bg-yellow-600 hover:text-white">24h Ban</button>
                    <button onclick="suspendUser('permanent')" class="bg-red-600/20 text-red-500 border border-red-600 p-2 rounded text-xs font-bold hover:bg-red-600 hover:text-white">Permanent Ban</button>
                </div>
                <button onclick="unsuspendUser()" class="w-full bg-green-600/20 text-green-500 border border-green-600 p-2 rounded text-xs font-bold mt-2 hover:bg-green-600 hover:text-white">Unban User</button>
            </div>
        </div>
    </div>

    <script>
        // --- CONFIGURATION ---
        const firebaseConfig = {
            apiKey: "AIzaSyDb_2_4r89AhNKceMJ80HvX-MOgSlcUegY",
            authDomain: "earning-ai-guide.firebaseapp.com",
            projectId: "earning-ai-guide",
            storageBucket: "earning-ai-guide.firebasestorage.app",
            messagingSenderId: "856725361260",
            appId: "1:856725361260:web:f3248390c3db55f65c3e49"
        };

        const APP_ID = 'RDS_FINAL_PRO_BUILD_V2';
        
        // Initialize
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        // Load Data
        window.onload = () => {
            loadDashboard();
            loadUsers();
            loadSettings();
        };

        // --- DASHBOARD LOGIC ---
        function loadDashboard() {
            // Count Users
            db.collection('artifacts').doc(APP_ID).collection('users').get().then(snap => {
                document.getElementById('total-users').innerText = snap.size;
                const banned = snap.docs.filter(d => d.data().isBanned).length;
                document.getElementById('banned-users').innerText = banned;
            });

            // Get Settings for Rate
            db.collection('artifacts').doc(APP_ID).collection('settings').doc('config').get().then(doc => {
                if(doc.exists) {
                    document.getElementById('current-rate').innerText = '$' + (doc.data().adRate || 0.01);
                }
            });
        }

        // --- USER MANAGEMENT ---
        function loadUsers() {
            const tbody = document.getElementById('user-table-body');
            tbody.innerHTML = '<tr><td colspan="5" class="p-4 text-center">Loading...</td></tr>';

            db.collection('artifacts').doc(APP_ID).collection('users').limit(50).onSnapshot(snap => {
                tbody.innerHTML = '';
                snap.forEach(doc => {
                    const u = doc.data();
                    let statusHtml = '<span class="status-badge bg-green-500/20 text-green-400">Active</span>';
                    
                    if(u.isBanned) {
                        statusHtml = `<span class="status-badge bg-red-500/20 text-red-400">${u.banType === 'permanent' ? 'Perm Ban' : '24h Ban'}</span>`;
                    }

                    const row = `
                        <tr class="border-b border-slate-700 hover:bg-slate-800/50">
                            <td class="p-4 font-bold text-white">${u.name}</td>
                            <td class="p-4 font-mono text-xs">${doc.id.substring(0,8)}...</td>
                            <td class="p-4 text-blue-400 font-bold">$${u.balance?.toFixed(3)}</td>
                            <td class="p-4">${statusHtml}</td>
                            <td class="p-4">
                                <button onclick="openUserModal('${doc.id}', '${u.name}', ${u.balance})" class="btn bg-slate-700 hover:bg-blue-600 text-white">Manage</button>
                            </td>
                        </tr>
                    `;
                    tbody.innerHTML += row;
                });
            });
        }

        // --- ACTIONS ---
        function openUserModal(uid, name, bal) {
            document.getElementById('modal-username').innerText = name;
            document.getElementById('modal-uid').value = uid;
            document.getElementById('modal-balance').value = bal;
            document.getElementById('userModal').style.display = 'flex';
        }

        function closeModal() {
            document.getElementById('userModal').style.display = 'none';
        }

        async function updateBalance() {
            const uid = document.getElementById('modal-uid').value;
            const newBal = parseFloat(document.getElementById('modal-balance').value);
            
            await db.collection('artifacts').doc(APP_ID).collection('users').doc(uid).update({
                balance: newBal
            });
            alert('‡¶¨‡ßç‡¶Ø‡¶æ‡¶≤‡ßá‡¶®‡ßç‡¶∏ ‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶π‡ßü‡ßá‡¶õ‡ßá!');
            closeModal();
        }

        async function suspendUser(type) {
            const uid = document.getElementById('modal-uid').value;
            let banData = { isBanned: true, banType: type, banTime: Date.now() };
            
            await db.collection('artifacts').doc(APP_ID).collection('users').doc(uid).update(banData);
            alert(`User ${type === 'permanent' ? 'Permanently' : '24h'} Banned!`);
            closeModal();
        }

        async function unsuspendUser() {
            const uid = document.getElementById('modal-uid').value;
            await db.collection('artifacts').doc(APP_ID).collection('users').doc(uid).update({
                isBanned: false, banType: null, banTime: null
            });
            alert('‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶Ü‡¶®‡¶¨‡ßç‡¶Ø‡¶æ‡¶® ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá!');
            closeModal();
        }

        // --- SETTINGS CONTROL ---
        async function loadSettings() {
            const doc = await db.collection('artifacts').doc(APP_ID).collection('settings').doc('config').get();
            if(doc.exists) {
                const data = doc.data();
                document.getElementById('set-rate').value = data.adRate;
                document.getElementById('set-limit').value = data.dailyLimit;
                document.getElementById('set-bonus').value = data.welcomeBonus;
            }
        }

        async function saveSettings() {
            const adRate = parseFloat(document.getElementById('set-rate').value);
            const dailyLimit = parseInt(document.getElementById('set-limit').value);
            const welcomeBonus = parseFloat(document.getElementById('set-bonus').value);

            await db.collection('artifacts').doc(APP_ID).collection('settings').doc('config').set({
                adRate, dailyLimit, welcomeBonus
            });
            alert('‡¶∏‡ßá‡¶ü‡¶ø‡¶Ç‡¶∏ ‡¶∏‡ßá‡¶≠ ‡¶π‡ßü‡ßá‡¶õ‡ßá!');
        }

        // Navigation Logic
        function showSection(id) {
            document.querySelectorAll('.section').forEach(s => s.classList.add('hidden'));
            document.getElementById(id).classList.remove('hidden');
            
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
            event.target.classList.add('active');
        }
    </script>
</body>
</html>