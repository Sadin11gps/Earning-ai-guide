<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>RDS TEAM - Verified</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap" rel="stylesheet">
    
    <style>
        body { background-color: #050810; font-family: 'Inter', sans-serif; color: #f8fafc; overflow: hidden; margin: 0; padding: 0; }
        
        /* Loading Animation */
        @keyframes fillProgress {
            0% { width: 0%; }
            100% { width: 100%; }
        }
        .loading-bar-fill {
            height: 100%;
            background: linear-gradient(90deg, #dc2626, #2563eb, #4f46e5);
            animation: fillProgress 3.5s linear forwards;
        }
        
        .nav-blur { backdrop-filter: blur(20px); background: rgba(15, 23, 42, 0.9); }
        .animate-up { animation: slideUp 0.4s ease-out forwards; }
        @keyframes slideUp { from { transform: translateY(20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        
        /* Custom UI fixes */
        ::-webkit-scrollbar { display: none; }
        .active-tab-icon { color: #3b82f6; transform: scale(1.1); transition: all 0.3s ease; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        const firebaseConfig = {
            apiKey: "AIzaSyDb_2_4r89AhNKceMJ80HvX-MOgSlcUegY",
            authDomain: "earning-ai-guide.firebaseapp.com",
            databaseURL: "https://earning-ai-guide-default-rtdb.firebaseio.com",
            projectId: "earning-ai-guide",
            storageBucket: "earning-ai-guide.firebasestorage.app",
            messagingSenderId: "856725361260",
            appId: "1:856725361260:web:f3248390c3db55f65c3e49"
        };

        const BOT_USERNAME = "earning_ai_guide_bot";
        const WELCOME_BONUS = 0.50; // $0.50
        const REFER_BONUS = 0.10;   // $0.10
        const AD_REWARD = 0.005;    // $0.005
        const MIN_WITHDRAW = 5.00;
        const appId = 'rds-team-v4-final';

        if (!firebase.apps.length) firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
        const auth = firebase.auth();

        const Icon = ({ name, size = 24, className = "" }) => {
            useEffect(() => { if (window.lucide) window.lucide.createIcons(); }, [name]);
            return <i data-lucide={name} className={className} style={{ width: size, height: size }}></i>;
        };

        const App = () => {
            const [loading, setLoading] = useState(true);
            const [activeTab, setActiveTab] = useState('home');
            const [userData, setUserData] = useState(null);
            const [user, setUser] = useState(null);
            const [copied, setCopied] = useState(false);
            const [withdrawAmount, setWithdrawAmount] = useState('');
            const [payoutMethod, setPayoutMethod] = useState('bKash');
            const [payoutAddress, setPayoutAddress] = useState('');

            useEffect(() => {
                const tg = window.Telegram.WebApp;
                tg.expand();
                const referrerId = tg.initDataUnsafe?.start_param;

                auth.signInAnonymously().then(({ user: currUser }) => {
                    setUser(currUser);
                    const userRef = db.collection('artifacts').doc(appId).collection('users').doc(currUser.uid).collection('profile').doc('data');
                    
                    userRef.onSnapshot(async (doc) => {
                        if (doc.exists) {
                            setUserData(doc.data());
                        } else {
                            // Logic: Welcome Bonus & Refer System
                            const newUser = {
                                uid: currUser.uid,
                                name: tg.initDataUnsafe?.user?.first_name || "User",
                                photo: tg.initDataUnsafe?.user?.photo_url || null,
                                earning_balance: WELCOME_BONUS,
                                refer_balance: 0,
                                referrals: 0,
                                clicks: 0,
                                isJoined: true, // Auto join for testing
                                referrer: referrerId || null
                            };
                            await userRef.set(newUser);

                            if (referrerId) {
                                const refRef = db.collection('artifacts').doc(appId).collection('users').doc(referrerId).collection('profile').doc('data');
                                await refRef.update({
                                    refer_balance: firebase.firestore.FieldValue.increment(REFER_BONUS),
                                    referrals: firebase.firestore.FieldValue.increment(1)
                                });
                            }
                        }
                    });
                });

                // Beautiful 3.5s loading time
                setTimeout(() => setLoading(false), 3800);
            }, []);

            const watchAd = () => {
                db.collection('artifacts').doc(appId).collection('users').doc(user.uid).collection('profile').doc('data').update({
                    earning_balance: firebase.firestore.FieldValue.increment(AD_REWARD),
                    clicks: firebase.firestore.FieldValue.increment(1)
                });
            };

            const submitWithdraw = async () => {
                const amount = parseFloat(withdrawAmount);
                if (amount < MIN_WITHDRAW) return alert(`Min withdraw $${MIN_WITHDRAW}`);
                if (amount > userData.earning_balance) return alert("Insufficient balance!");
                if (!payoutAddress) return alert("Enter wallet address!");

                await db.collection('artifacts').doc(appId).collection('payouts').add({
                    uid: user.uid,
                    name: userData.name,
                    amount,
                    method: payoutMethod,
                    address: payoutAddress,
                    status: 'pending',
                    timestamp: new Date().getTime()
                });

                await db.collection('artifacts').doc(appId).collection('users').doc(user.uid).collection('profile').doc('data').update({
                    earning_balance: firebase.firestore.FieldValue.increment(-amount)
                });

                alert("উইথড্র রিকোয়েস্ট সফল হয়েছে!");
                setWithdrawAmount('');
                setPayoutAddress('');
            };

            if (loading) return (
                <div className="h-screen flex flex-col items-center justify-center bg-[#050810]">
                    <Icon name="heart" size={100} className="text-red-600 fill-red-600 animate-pulse mb-8 drop-shadow-[0_0_20px_rgba(220,38,38,0.5)]" />
                    <h1 className="text-4xl font-black tracking-[0.2em] italic text-white mb-6">RDS TEAM</h1>
                    <div className="w-64 h-1.5 bg-slate-900 rounded-full overflow-hidden border border-white/5 shadow-inner">
                        <div className="loading-bar-fill"></div>
                    </div>
                    <p className="mt-6 text-[10px] text-slate-500 uppercase tracking-[0.6em] font-bold">Powered by RDS Team</p>
                </div>
            );

            return (
                <div className="flex flex-col h-screen relative">
                    {/* Header */}
                    <div className="px-6 py-5 flex justify-between items-center bg-[#0f172a]/60 border-b border-white/5 z-20">
                        <div className="flex items-center gap-2">
                            <div className="w-8 h-8 bg-blue-600 rounded-lg flex items-center justify-center font-black">R</div>
                            <span className="font-black italic text-xl tracking-tighter">RDS TEAM</span>
                        </div>
                        <div className="w-10 h-10 rounded-full border-2 border-blue-600/30 overflow-hidden shadow-lg" onClick={() => setActiveTab('profile')}>
                            {userData?.photo ? <img src={userData.photo} className="w-full h-full object-cover" /> : <div className="w-full h-full bg-blue-600 flex items-center justify-center font-bold">{userData?.name?.[0]}</div>}
                        </div>
                    </div>

                    <main className="flex-1 overflow-y-auto p-6 pb-36">
                        {activeTab === 'home' && (
                            <div className="space-y-6 animate-up">
                                <div className="bg-gradient-to-br from-blue-600 to-indigo-800 p-8 rounded-[2.5rem] shadow-2xl relative overflow-hidden">
                                    <Icon name="banknote" size={100} className="absolute -right-4 -top-4 opacity-10" />
                                    <p className="text-white/70 text-[10px] font-black uppercase tracking-widest">Main Balance</p>
                                    <h2 className="text-4xl font-black mt-1 tracking-tight text-white">${(userData?.earning_balance + userData?.refer_balance)?.toFixed(3)}</h2>
                                    <div className="mt-5 flex gap-3">
                                        <div className="bg-black/20 px-4 py-2 rounded-2xl text-[10px] font-black uppercase">Earn: ${userData?.earning_balance?.toFixed(2)}</div>
                                        <div className="bg-black/20 px-4 py-2 rounded-2xl text-[10px] font-black uppercase">Ref: ${userData?.refer_balance?.toFixed(2)}</div>
                                    </div>
                                </div>

                                <button onClick={watchAd} className="w-full bg-slate-900 border border-blue-500/20 p-6 rounded-[3rem] flex items-center justify-between shadow-2xl active:scale-95 transition-all">
                                    <div className="flex items-center gap-4">
                                        <div className="p-4 bg-blue-600/10 rounded-2xl text-blue-500">
                                            <Icon name="video" size={32} />
                                        </div>
                                        <div className="text-left">
                                            <h4 className="font-black text-lg text-white">Watch Video Ads</h4>
                                            <p className="text-[10px] text-slate-500 font-bold uppercase">Earn ${AD_REWARD} Per Click</p>
                                        </div>
                                    </div>
                                    <Icon name="chevron-right" className="text-slate-700" />
                                </button>

                                <div className="grid grid-cols-2 gap-4">
                                    <div className="bg-[#111827] p-6 rounded-3xl border border-white/5 text-center">
                                        <Icon name="mouse-pointer" size={24} className="mx-auto text-blue-500 mb-2" />
                                        <p className="text-[10px] text-slate-500 font-black uppercase">Ad Clicks</p>
                                        <p className="text-2xl font-black">{userData?.clicks}</p>
                                    </div>
                                    <div className="bg-[#111827] p-6 rounded-3xl border border-white/5 text-center">
                                        <Icon name="users" size={24} className="mx-auto text-green-500 mb-2" />
                                        <p className="text-[10px] text-slate-500 font-black uppercase">Total Refer</p>
                                        <p className="text-2xl font-black">{userData?.referrals}</p>
                                    </div>
                                </div>
                            </div>
                        )}

                        {activeTab === 'refer' && (
                            <div className="space-y-6 text-center animate-up">
                                <Icon name="user-plus" size={80} className="mx-auto text-indigo-500 mb-2 p-5 bg-indigo-500/10 rounded-[2.5rem]" />
                                <h3 className="text-3xl font-black italic uppercase">Invite & Earn</h3>
                                <p className="text-slate-400 text-sm font-medium px-4">প্রতিটি বন্ধুর জন্য পাবেন ${REFER_BONUS} বোনাস!</p>
                                <div className="bg-slate-900 p-8 rounded-[3rem] border border-slate-800 shadow-2xl">
                                    <p className="text-[10px] font-black text-slate-500 uppercase mb-4 tracking-widest">Your Referral Link</p>
                                    <div className="flex items-center gap-2 bg-black/40 p-4 rounded-2xl border border-white/5">
                                        <span className="text-[10px] truncate flex-1 font-mono text-blue-400">t.me/{BOT_USERNAME}?start={user?.uid}</span>
                                        <button onClick={() => { navigator.clipboard.writeText(`https://t.me/${BOT_USERNAME}?start=${user?.uid}`); setCopied(true); setTimeout(()=>setCopied(false), 2000); }} className={`p-3 rounded-xl ${copied ? 'bg-green-600' : 'bg-blue-600'} active:scale-90 transition-all`}>
                                            <Icon name={copied ? "check" : "copy"} size={18} />
                                        </button>
                                    </div>
                                </div>
                            </div>
                        )}

                        {activeTab === 'payout' && (
                            <div className="space-y-6 animate-up">
                                <h3 className="text-2xl font-black italic uppercase">Withdraw Money</h3>
                                <div className="bg-slate-900 p-8 rounded-[3rem] border border-blue-500/10 shadow-2xl">
                                    <div className="mb-6">
                                        <p className="text-[10px] font-black text-slate-500 uppercase tracking-widest">উত্তোলনযোগ্য ব্যালেন্স</p>
                                        <h2 className="text-4xl font-black text-blue-500 mt-1">${userData?.earning_balance?.toFixed(2)}</h2>
                                    </div>
                                    <div className="space-y-4">
                                        <select value={payoutMethod} onChange={e=>setPayoutMethod(e.target.value)} className="w-full bg-black/40 border border-white/10 p-5 rounded-2xl outline-none font-black text-sm">
                                            <option value="bKash">bKash (Personal)</option>
                                            <option value="Nagad">Nagad (Personal)</option>
                                            <option value="Binance">Binance (USDT)</option>
                                            <option value="TRX">Tron (TRX)</option>
                                        </select>
                                        <input type="number" placeholder="পরিমাণ ($)" value={withdrawAmount} onChange={e=>setWithdrawAmount(e.target.value)} className="w-full bg-black/40 border border-white/10 p-5 rounded-2xl outline-none font-black text-sm" />
                                        <input type="text" placeholder="বিকাশ নম্বর / ওয়ালেট এড্রেস" value={payoutAddress} onChange={e=>setPayoutAddress(e.target.value)} className="w-full bg-black/40 border border-white/10 p-5 rounded-2xl outline-none font-black text-sm" />
                                        <button onClick={submitWithdraw} className="w-full bg-blue-600 py-6 rounded-[2rem] font-black text-lg shadow-xl shadow-blue-900/40 active:scale-95 transition-all mt-4">WITHDRAW NOW</button>
                                    </div>
                                    <p className="text-center text-[10px] text-slate-500 font-bold uppercase mt-6 tracking-widest">Min Withdraw: $5.00 | 24h Payout</p>
                                </div>
                            </div>
                        )}

                        {activeTab === 'history' && (
                            <div className="text-center py-20 animate-up">
                                <div className="w-24 h-24 bg-slate-900 rounded-full flex items-center justify-center mx-auto mb-4 border border-white/5 shadow-inner">
                                    <Icon name="history" size={40} className="text-slate-800" />
                                </div>
                                <p className="text-slate-500 text-[10px] font-black uppercase tracking-widest">No Recent Activity Found</p>
                            </div>
                        )}

                        {activeTab === 'profile' && (
                            <div className="space-y-6 animate-up">
                                <div className="bg-slate-900 p-12 rounded-[3.5rem] text-center relative overflow-hidden border border-white/5 shadow-2xl">
                                    <div className="absolute top-0 left-0 w-full h-1.5 bg-gradient-to-r from-red-600 via-blue-600 to-indigo-600 opacity-50"></div>
                                    <div className="w-24 h-24 rounded-full mx-auto mb-4 border-4 border-slate-900 shadow-2xl overflow-hidden bg-slate-800">
                                        {userData?.photo ? <img src={userData.photo} className="w-full h-full object-cover" /> : <div className="w-full h-full bg-blue-600 flex items-center justify-center text-4xl font-black">{userData?.name?.[0]}</div>}
                                    </div>
                                    <h4 className="text-2xl font-black text-white">{userData?.name}</h4>
                                    <p className="text-slate-500 text-[10px] font-black uppercase tracking-widest mt-1">RDS Member • {user?.uid?.substring(0,8)}</p>
                                </div>
                                <div className="bg-slate-900 rounded-[2.5rem] overflow-hidden border border-white/5 shadow-xl">
                                    <div className="p-6 border-b border-white/5 flex justify-between items-center hover:bg-white/5 transition-colors">
                                        <div className="flex items-center gap-4"><Icon name="message-square" className="text-blue-500" /><span className="text-xs font-black uppercase">Live Support</span></div>
                                        <Icon name="chevron-right" size={16} className="text-slate-700" />
                                    </div>
                                    <div className="p-6 flex justify-between items-center hover:bg-white/5 transition-colors">
                                        <div className="flex items-center gap-4"><Icon name="shield" className="text-indigo-500" /><span className="text-xs font-black uppercase">Terms & Privacy</span></div>
                                        <Icon name="chevron-right" size={16} className="text-slate-700" />
                                    </div>
                                </div>
                            </div>
                        )}
                    </main>

                    {/* Bottom Nav */}
                    <nav className="fixed bottom-0 left-0 right-0 nav-blur border-t border-white/5 p-4 pb-12 flex justify-around items-end z-50">
                        <button onClick={() => setActiveTab('home')} className={`flex flex-col items-center gap-1.5 transition-all ${activeTab === 'home' ? 'text-blue-500 scale-110' : 'text-slate-600'}`}>
                            <Icon name="home" />
                            <span className="text-[9px] font-black uppercase tracking-widest">Home</span>
                        </button>
                        <button onClick={() => setActiveTab('refer')} className={`flex flex-col items-center gap-1.5 transition-all ${activeTab === 'refer' ? 'text-blue-500 scale-110' : 'text-slate-600'}`}>
                            <Icon name="users" />
                            <span className="text-[9px] font-black uppercase tracking-widest">Refer</span>
                        </button>
                        
                        <button onClick={() => setActiveTab('payout')} className="relative -top-8 group">
                            <div className={`w-16 h-16 rounded-full flex items-center justify-center shadow-[0_0_30px_rgba(37,99,235,0.4)] transition-all transform duration-300 ${activeTab === 'payout' ? 'bg-blue-600 rotate-12 scale-110' : 'bg-slate-800 group-hover:bg-slate-700'}`}>
                                <Icon name="wallet" className="text-white" size={30} />
                            </div>
                        </button>

                        <button onClick={() => setActiveTab('history')} className={`flex flex-col items-center gap-1.5 transition-all ${activeTab === 'history' ? 'text-blue-500 scale-110' : 'text-slate-600'}`}>
                            <Icon name="history" />
                            <span className="text-[9px] font-black uppercase tracking-widest">History</span>
                        </button>
                        <button onClick={() => setActiveTab('profile')} className={`flex flex-col items-center gap-1.5 transition-all ${activeTab === 'profile' ? 'text-blue-500 scale-110' : 'text-slate-600'}`}>
                            <Icon name="user" />
                            <span className="text-[9px] font-black uppercase tracking-widest">Profile</span>
                        </button>
                    </nav>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>