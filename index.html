<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RDS TEAM - Earning App</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #050810; margin: 0; overflow: hidden; }
        @keyframes loading { 0% { width: 0%; } 100% { width: 100%; } }
        .animate-loading { animation: loading 3.5s linear forwards; }
        .custom-shadow { shadow-[0_0_50px_rgba(37,99,235,0.15)] }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // --- CONFIGURATION ---
        const firebaseConfig = {
            apiKey: "AIzaSyDb_2_4r89AhNKceMJ80HvX-MOgSlcUegY",
            authDomain: "earning-ai-guide.firebaseapp.com",
            databaseURL: "https://earning-ai-guide-default-rtdb.firebaseio.com",
            projectId: "earning-ai-guide",
            storageBucket: "earning-ai-guide.firebasestorage.app",
            messagingSenderId: "856725361260",
            appId: "1:856725361260:web:f3248390c3db55f65c3e49"
        };

        const BOT_USERNAME = "earning_ai_guide_bot";
        const ADMIN_ID = "7702378694";
        const CHANNEL_LINK = "https://t.me/amrrdsteam";
        const appId = 'rds-team-pro-live';

        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();

        const App = () => {
            const [loading, setLoading] = useState(true);
            const [user, setUser] = useState(null);
            const [userData, setUserData] = useState(null);
            const [tgUser, setTgUser] = useState(null);
            const [activeTab, setActiveTab] = useState('home');

            useEffect(() => {
                const tg = window.Telegram.WebApp;
                tg.expand();
                setTgUser(tg.initDataUnsafe?.user);

                const startParam = tg.initDataUnsafe?.start_param;

                auth.signInAnonymously().then(() => {
                    auth.onAuthStateChanged(async (currUser) => {
                        if (currUser) {
                            setUser(currUser);
                            await syncUser(currUser.uid, startParam, tg.initDataUnsafe?.user);
                        }
                    });
                });

                setTimeout(() => setLoading(false), 3500);
            }, []);

            const syncUser = async (uid, referrerId, telegramUser) => {
                const userRef = db.collection('artifacts').doc(appId).collection('users').doc(uid).collection('profile').doc('data');
                const doc = await userRef.get();

                if (!doc.exists) {
                    const newUser = {
                        uid,
                        name: telegramUser?.first_name || 'Guest User',
                        photo: telegramUser?.photo_url || null,
                        earning_balance: 0,
                        refer_balance: 0,
                        referrals: 0,
                        isJoined: false,
                        joinedAt: Date.now()
                    };
                    await userRef.set(newUser);
                } else if (telegramUser?.photo_url) {
                    await userRef.update({ photo: telegramUser.photo_url, name: telegramUser.first_name });
                }

                userRef.onSnapshot(snap => setUserData(snap.data()));
            };

            if (loading) {
                return (
                    <div className="h-screen flex flex-col items-center justify-center text-white bg-[#050810]">
                        <div className="mb-6">
                            <svg className="w-24 h-24 text-red-600 animate-pulse fill-current drop-shadow-[0_0_20px_rgba(220,38,38,0.6)]" viewBox="0 0 24 24">
                                <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>
                            </svg>
                        </div>
                        <h1 className="text-4xl font-black tracking-[0.2em] italic mb-4">RDS TEAM</h1>
                        <div className="w-56 h-1 bg-slate-900 rounded-full overflow-hidden border border-slate-800/50">
                            <div className="h-full bg-gradient-to-r from-red-600 via-blue-600 to-indigo-600 animate-loading"></div>
                        </div>
                        <p className="mt-4 text-[9px] text-slate-500 uppercase tracking-[0.5em] font-bold">Powered by RDS Team</p>
                    </div>
                );
            }

            return (
                <div className="flex flex-col h-screen text-slate-200">
                    <header className="px-6 py-4 flex justify-between items-center bg-[#0f172a]/40 border-b border-white/5 shadow-2xl">
                        <div className="flex items-center gap-2">
                            <div className="w-8 h-8 bg-blue-600 rounded-lg flex items-center justify-center font-black text-white shadow-lg">R</div>
                            <span className="font-black text-xl italic">RDS TEAM</span>
                        </div>
                        <div className="flex items-center gap-3">
                            <div className="text-right">
                                <p className="text-[10px] font-bold text-blue-500 leading-none">ACTIVE</p>
                                <p className="text-xs font-black">{userData?.name?.split(' ')[0]}</p>
                            </div>
                            <div className="w-10 h-10 rounded-full border-2 border-blue-600/20 overflow-hidden bg-slate-900">
                                {userData?.photo ? <img src={userData.photo} className="w-full h-full object-cover" /> : <div className="w-full h-full flex items-center justify-center bg-blue-600 font-bold">{userData?.name?.[0]}</div>}
                            </div>
                        </div>
                    </header>

                    <main className="flex-1 p-6 overflow-y-auto">
                        <div className="grid grid-cols-2 gap-4 mb-6">
                            <div className="bg-gradient-to-br from-blue-600 to-blue-900 p-6 rounded-[2rem] border border-white/10">
                                <p className="text-white/60 text-[9px] font-black uppercase tracking-widest">Balance</p>
                                <h3 className="text-2xl font-black mt-1">${userData?.earning_balance?.toFixed(3) || '0.000'}</h3>
                            </div>
                            <div className="bg-gradient-to-br from-indigo-600 to-indigo-950 p-6 rounded-[2rem] border border-white/10">
                                <p className="text-white/60 text-[9px] font-black uppercase tracking-widest">Refer</p>
                                <h3 className="text-2xl font-black mt-1">${userData?.refer_balance?.toFixed(3) || '0.000'}</h3>
                            </div>
                        </div>
                        
                        <div className="bg-[#0f172a] p-8 rounded-[2.5rem] border border-blue-500/10 text-center">
                            <h4 className="font-black text-xl mb-2">Welcome Back!</h4>
                            <p className="text-slate-400 text-xs mb-6 font-medium">আপনার প্রোফাইল এবং ইনকাম ডাটা এখন লাইভ।</p>
                            <button className="w-full bg-blue-600 py-4 rounded-2xl font-black shadow-lg shadow-blue-900/40">EARN NOW</button>
                        </div>
                    </main>

                    <nav className="p-6 bg-[#0f172a]/80 border-t border-white/5 flex justify-around pb-10">
                        <div className="text-blue-500 flex flex-col items-center gap-1">
                            <div className="w-6 h-6 bg-current rounded-sm opacity-20 absolute"></div>
                            <span className="text-[10px] font-black uppercase">Home</span>
                        </div>
                        <div className="text-slate-600 flex flex-col items-center gap-1">
                             <span className="text-[10px] font-black uppercase">Refer</span>
                        </div>
                        <div className="text-slate-600 flex flex-col items-center gap-1">
                             <span className="text-[10px] font-black uppercase">Profile</span>
                        </div>
                    </nav>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>